# CARINA MissionLab - USB Device Rules
# Provides non-root access to common USB devices for embedded development
#
# These rules ensure programmers, debuggers, and development boards
# are accessible without sudo for users in the plugdev group.

# ============================================================================
# PROGRAMMERS AND DEBUGGERS
# ============================================================================

# Atmel/Microchip AVR programmers
# USBasp
SUBSYSTEM=="usb", ATTR{idVendor}=="16c0", ATTR{idProduct}=="05dc", GROUP="plugdev", MODE="0666"
# AVR ISP mkII
SUBSYSTEM=="usb", ATTR{idVendor}=="03eb", ATTR{idProduct}=="2104", GROUP="plugdev", MODE="0666"
# AVRISP
SUBSYSTEM=="usb", ATTR{idVendor}=="03eb", ATTR{idProduct}=="2103", GROUP="plugdev", MODE="0666"

# STMicroelectronics ST-Link debuggers
# ST-Link V2
SUBSYSTEM=="usb", ATTR{idVendor}=="0483", ATTR{idProduct}=="3748", GROUP="plugdev", MODE="0666"
# ST-Link V2-1
SUBSYSTEM=="usb", ATTR{idVendor}=="0483", ATTR{idProduct}=="374b", GROUP="plugdev", MODE="0666"
# ST-Link V3
SUBSYSTEM=="usb", ATTR{idVendor}=="0483", ATTR{idProduct}=="374e", GROUP="plugdev", MODE="0666"
SUBSYSTEM=="usb", ATTR{idVendor}=="0483", ATTR{idProduct}=="374f", GROUP="plugdev", MODE="0666"

# Segger J-Link debuggers
SUBSYSTEM=="usb", ATTR{idVendor}=="1366", GROUP="plugdev", MODE="0666"

# Black Magic Probe
SUBSYSTEM=="usb", ATTR{idVendor}=="1d50", ATTR{idProduct}=="6018", GROUP="plugdev", MODE="0666"

# CMSIS-DAP compatible debuggers
SUBSYSTEM=="usb", ATTR{idVendor}=="0d28", GROUP="plugdev", MODE="0666"

# ============================================================================
# DEVELOPMENT BOARDS (DFU/Bootloader mode)
# ============================================================================

# Arduino boards in DFU mode
SUBSYSTEM=="usb", ATTR{idVendor}=="2341", GROUP="plugdev", MODE="0666"
SUBSYSTEM=="usb", ATTR{idVendor}=="2a03", GROUP="plugdev", MODE="0666"

# STM32 DFU bootloader
SUBSYSTEM=="usb", ATTR{idVendor}=="0483", ATTR{idProduct}=="df11", GROUP="plugdev", MODE="0666"

# Raspberry Pi Pico (RP2040) in BOOTSEL mode
SUBSYSTEM=="usb", ATTR{idVendor}=="2e8a", ATTR{idProduct}=="0003", GROUP="plugdev", MODE="0666"
SUBSYSTEM=="usb", ATTR{idVendor}=="2e8a", ATTR{idProduct}=="000a", GROUP="plugdev", MODE="0666"

# Teensy boards (bootloader)
SUBSYSTEM=="usb", ATTR{idVendor}=="16c0", ATTR{idProduct}=="0478", GROUP="plugdev", MODE="0666"
SUBSYSTEM=="usb", ATTR{idVendor}=="16c0", ATTR{idProduct}=="0483", GROUP="plugdev", MODE="0666"

# ESP32/ESP8266 in download mode
SUBSYSTEM=="usb", ATTR{idVendor}=="303a", GROUP="plugdev", MODE="0666"

# ============================================================================
# USB-TO-SERIAL ADAPTERS (non-tty access)
# ============================================================================

# FTDI devices
SUBSYSTEM=="usb", ATTR{idVendor}=="0403", GROUP="plugdev", MODE="0666"

# Silicon Labs CP210x
SUBSYSTEM=="usb", ATTR{idVendor}=="10c4", GROUP="plugdev", MODE="0666"

# WCH CH340/CH341
SUBSYSTEM=="usb", ATTR{idVendor}=="1a86", GROUP="plugdev", MODE="0666"

# ============================================================================
# LOGIC ANALYZERS AND TEST EQUIPMENT
# ============================================================================

# Saleae Logic Analyzer
SUBSYSTEM=="usb", ATTR{idVendor}=="0925", GROUP="plugdev", MODE="0666"
SUBSYSTEM=="usb", ATTR{idVendor}=="21a9", GROUP="plugdev", MODE="0666"

# Sigrok-compatible devices
SUBSYSTEM=="usb", ATTR{idVendor}=="1d50", ATTR{idProduct}=="608c", GROUP="plugdev", MODE="0666"

# ============================================================================
# TAGGING
# ============================================================================

# Tag all CARINA-managed USB devices
SUBSYSTEM=="usb", ATTR{idVendor}=="*", TAG+="carina-usb"
